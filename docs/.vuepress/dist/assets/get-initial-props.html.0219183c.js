import{_ as o,r as p,o as c,c as l,b as n,d as s,e as t,a as e}from"./app.1ad2624e.js";const r={},i=n("h1",{id:"getinitialprops",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#getinitialprops","aria-hidden":"true"},"#"),s(" getInitialProps")],-1),u=n("strong",null,"Note",-1),d=n("code",null,"app/",-1),k={href:"https://beta.nextjs.org/docs/data-fetching/fundamentals",target:"_blank",rel:"noopener noreferrer"},g=n("code",null,"use",-1),h=n("code",null,"fetch",-1),_={href:"https://beta.nextjs.org/docs/upgrade-guide",target:"_blank",rel:"noopener noreferrer"},f=n("code",null,"app/",-1),y=n("code",null,"getInitialProps",-1),m=n("a",{href:"/docs/guide/basic-features/pages#server-side-rendering"},"server-side rendering",-1),w=n("strong",null,"initial data population",-1),x=n("a",{href:"/docs/guide/basic-features/pages"},"page",-1),b={href:"https://en.wikipedia.org/wiki/Search_engine_optimization",target:"_blank",rel:"noopener noreferrer"},v=n("p",null,[n("code",null,"getInitialProps"),s("will disable"),n("a",{href:"/docs/guide/advanced-features/automatic-static-optimization"},"Automatic Static Optimization"),s(".")],-1),P=n("code",null,"getInitialProps",-1),j=n("code",null,"async",-1),I={href:"https://javascript.info/static-properties-methods",target:"_blank",rel:"noopener noreferrer"},N=n("code",null,"static method",-1),A=e(`<div class="language-jsx" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> stars <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Next stars: </span><span class="token punctuation">{</span>stars<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>

Page<span class="token punctuation">.</span><span class="token function-variable function">getInitialProps</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://api.github.com/repos/vercel/next.js&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">stars</span><span class="token operator">:</span> json<span class="token punctuation">.</span>stargazers_count <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Page

</code></pre></div><p>Or using a class component:</p><div class="language-jsx" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>

<span class="token keyword">class</span> <span class="token class-name">Page</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">getInitialProps</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://api.github.com/repos/vercel/next.js&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">stars</span><span class="token operator">:</span> json<span class="token punctuation">.</span>stargazers_count <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Next stars: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>stars<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Page

</code></pre></div><p><code>getInitialProps</code>is used to asynchronously fetch some data, which then populates<code>props</code>.</p>`,4),S=n("code",null,"getInitialProps",-1),T={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify",target:"_blank",rel:"noopener noreferrer"},q=n("code",null,"JSON.stringify",-1),C=n("code",null,"getInitialProps",-1),R=n("code",null,"Object",-1),O=n("code",null,"Date",-1),z=n("code",null,"Map",-1),E=n("code",null,"Set",-1),L=e('<p>For the initial page load,<code>getInitialProps</code>will run on the server only.<code>getInitialProps</code>will then run on the client when navigating to a different route via the<a href="/docs/guide/api-reference/next/link"><code>next/link</code></a>component or by using<a href="/docs/guide/api-reference/next/router"><code>next/router</code></a>. However, if<code>getInitialProps</code>is used in a custom<code>_app.js</code>, and the page being navigated to implements<code>getServerSideProps</code>, then<code>getInitialProps</code>will run on the server.</p><h2 id="context-object" tabindex="-1"><a class="header-anchor" href="#context-object" aria-hidden="true">#</a> Context Object</h2><p><code>getInitialProps</code>receives a single argument called<code>context</code>, it&#39;s an object with the following properties:</p>',3),H=n("code",null,"pathname",-1),M=n("code",null,"/pages",-1),V=n("code",null,"query",-1),B=n("code",null,"asPath",-1),J=n("code",null,"String",-1),D=n("code",null,"req",-1),F={href:"https://nodejs.org/api/http.html#http_class_http_incomingmessage",target:"_blank",rel:"noopener noreferrer"},U=n("code",null,"res",-1),W={href:"https://nodejs.org/api/http.html#http_class_http_serverresponse",target:"_blank",rel:"noopener noreferrer"},Y=n("code",null,"err",-1),G=n("h2",{id:"caveats",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#caveats","aria-hidden":"true"},"#"),s(" Caveats")],-1),Q=n("code",null,"getInitialProps",-1),K=n("strong",null,"not",-1),X=n("code",null,"getInitialProps",-1),Z={href:"https://arunoda.me/blog/ssr-and-server-only-modules",target:"_blank",rel:"noopener noreferrer"},$=n("code",null,"props",-1),nn={href:"https://reactjs.org/docs/react-dom.html#hydrate",target:"_blank",rel:"noopener noreferrer"},sn=n("code",null,"props",-1),an=e(`<h2 id="typescript" tabindex="-1"><a class="header-anchor" href="#typescript" aria-hidden="true">#</a> TypeScript</h2><p>If you&#39;re using TypeScript, you can use the<code>NextPage</code>type for function components:</p><div class="language-jsx" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NextPage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">{</span>
  userAgent<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token literal-property property">Page</span><span class="token operator">:</span> NextPage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Props</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = ({ userAgent }) =&gt; (
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Your user agent: </span><span class="token punctuation">{</span>userAgent<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
)

Page.getInitialProps = async ({ req }) =&gt; </span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> userAgent <span class="token operator">=</span> req <span class="token operator">?</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;user-agent&#39;</span><span class="token punctuation">]</span> <span class="token operator">:</span> navigator<span class="token punctuation">.</span>userAgent
  <span class="token keyword">return</span> <span class="token punctuation">{</span> userAgent <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token plain-text">

export default Page

</span></code></pre></div><p>And for<code>React.Component</code>, you can use<code>NextPageContext</code>:</p><div class="language-jsx" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NextPageContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">{</span>
  userAgent<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Page</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Props</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">getInitialProps</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> req <span class="token punctuation">}</span><span class="token operator">:</span> NextPageContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> userAgent <span class="token operator">=</span> req <span class="token operator">?</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;user-agent&#39;</span><span class="token punctuation">]</span> <span class="token operator">:</span> navigator<span class="token punctuation">.</span>userAgent
    <span class="token keyword">return</span> <span class="token punctuation">{</span> userAgent <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> userAgent <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Your user agent: </span><span class="token punctuation">{</span>userAgent<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token plain-text">

</span></code></pre></div><h2 id="related" tabindex="-1"><a class="header-anchor" href="#related" aria-hidden="true">#</a> Related</h2><p>For more information on what to do next, we recommend the following sections:</p>`,7);function tn(en,on){const a=p("ExternalLinkIcon");return c(),l("div",null,[i,n("blockquote",null,[n("p",null,[u,s(": Next.js 13 introduces the"),d,s("directory (beta). This new directory has support for"),n("a",k,[s("colocated data fetching"),t(a)]),s("at the component level, using the new React"),g,s("hook and an extended"),h,s("Web API."),n("a",_,[s("Learn more about incrementally adopting"),f,t(a)]),s(".")])]),n("p",null,[y,s("enables"),m,s("in a page and allows you to do"),w,s(", it means sending the"),x,s("with the data already populated from the server. This is especially useful for"),n("a",b,[s("SEO"),t(a)]),s(".")]),v,n("p",null,[P,s("is an"),j,s("function that can be added to any page as a"),n("a",I,[N,t(a)]),s(". Take a look at the following example:")]),A,n("p",null,[s("Data returned from"),S,s("is serialized when server rendering, similar to what"),n("a",T,[q,t(a)]),s("does. Make sure the returned object from"),C,s("is a plain"),R,s("and not using"),O,s(","),z,s("or"),E,s(".")]),L,n("ul",null,[n("li",null,[H,s("- Current route. That is the path of the page in"),M,s("- "),V,s("- Query string section of URL parsed as an object- "),B,s("-"),J,s("of the actual path (including the query) shown in the browser- "),D,s("-"),n("a",F,[s("HTTP request object"),t(a)]),s("(server only)- "),U,s("-"),n("a",W,[s("HTTP response object"),t(a)]),s("(server only)- "),Y,s("- Error object if any error is encountered during the rendering")])]),G,n("ul",null,[n("li",null,[Q,s("can"),K,s("be used in children components, only in the default export of every page- If you are using server-side only modules inside"),X,s(", make sure to"),n("a",Z,[s("import them properly"),t(a)]),s(", otherwise it'll slow down your app")])]),n("blockquote",null,[n("p",null,[s("Note that irrespective of rendering type, any"),$,s("will be passed to the page component and can be viewed on the client-side in the initial HTML. This is to allow the page to be"),n("a",nn,[s("hydrated"),t(a)]),s("correctly. Make sure that you don't pass any sensitive information that shouldn't be available on the client in"),sn,s(".")])]),an])}const cn=o(r,[["render",tn],["__file","get-initial-props.html.vue"]]);export{cn as default};
