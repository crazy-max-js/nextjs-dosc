import{_ as e,r as t,o,c as p,b as a,d as c,e as l,a as n}from"./app.1ad2624e.js";const r={},i=n(`<h1 id="getstaticpaths" tabindex="-1"><a class="header-anchor" href="#getstaticpaths" aria-hidden="true">#</a> getStaticPaths</h1><details class="custom-container details"><summary>示例</summary><p>Version History</p></details><p>When exporting a function called<code>getStaticPaths</code>from a page that uses<a href="/docs/guide/routing/dynamic-routes">Dynamic Routes</a>, Next.js will statically pre-render all the paths specified by<code>getStaticPaths</code>.</p><div class="language-jsx" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">paths</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token comment">// See the &quot;paths&quot; section below</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">fallback</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span> or <span class="token string">&quot;blocking&quot;</span> <span class="token comment">// See the &quot;fallback&quot; section below</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="getstaticpaths-return-values" tabindex="-1"><a class="header-anchor" href="#getstaticpaths-return-values" aria-hidden="true">#</a> getStaticPaths return values</h2><p>The<code>getStaticPaths</code>function should return an object with the following<strong>required</strong>properties:</p><h3 id="paths" tabindex="-1"><a class="header-anchor" href="#paths" aria-hidden="true">#</a> paths</h3><p>The<code>paths</code>key determines which paths will be pre-rendered. For example, suppose that you have a page that uses<a href="/docs/guide/routing/dynamic-routes">Dynamic Routes</a>named<code>pages/posts/[id].js</code>. If you export<code>getStaticPaths</code>from this page and return the following for<code>paths</code>:</p><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">return</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">paths</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;1&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// with i18n configured the locale for the path can be returned as well</span>
      <span class="token literal-property property">locale</span><span class="token operator">:</span> <span class="token string">&quot;en&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">fallback</span><span class="token operator">:</span> <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Then, Next.js will statically generate<code>/posts/1</code>and<code>/posts/2</code>during<code>next build</code>using the page component in<code>pages/posts/[id].js</code>.</p><p>The value for each<code>params</code>object must match the parameters used in the page name:</p><ul><li>If the page name is<code>pages/posts/[postId]/[commentId]</code>, then<code>params</code>should contain<code>postId</code>and<code>commentId</code>.- If the page name uses<a href="/docs/guide/routing/dynamic-routes#catch-all-routes">catch-all routes</a>like<code>pages/[...slug]</code>, then<code>params</code>should contain<code>slug</code>(which is an array). If this array is<code>[&#39;hello&#39;, &#39;world&#39;]</code>, then Next.js will statically generate the page at<code>/hello/world</code>.- If the page uses an<a href="/docs/guide/routing/dynamic-routes#optional-catch-all-routes">optional catch-all route</a>, use<code>null</code>,<code>[]</code>,<code>undefined</code>or<code>false</code>to render the root-most route. For example, if you supply<code>slug: false</code>for<code>pages/[[...slug]]</code>, Next.js will statically generate the page<code>/</code>.</li></ul><p>The<code>params</code>strings are<strong>case-sensitive</strong>and ideally should be normalized to ensure the paths are generated correctly. For example, if<code>WoRLD</code>is returned for a param it will only match if<code>WoRLD</code>is the actual path visited, not<code>world</code>or<code>World</code>.</p><p>Separate of the<code>params</code>object a<code>locale</code>field can be returned when<a href="/docs/guide/advanced-features/i18n-routing">i18n is configured</a>, which configures the locale for the path being generated.</p><h3 id="fallback-false" tabindex="-1"><a class="header-anchor" href="#fallback-false" aria-hidden="true">#</a> fallback: false</h3><p>If<code>fallback</code>is<code>false</code>, then any paths not returned by<code>getStaticPaths</code>will result in a<strong>404 page</strong>.</p><p>When<code>next build</code>is run, Next.js will check if<code>getStaticPaths</code>returned<code>fallback: false</code>, it will then build<strong>only</strong>the paths returned by<code>getStaticPaths</code>. This option is useful if you have a small number of paths to create, or new page data is not added often. If you find that you need to add more paths, and you have<code>fallback: false</code>, you will need to run<code>next build</code>again so that the new paths can be generated.</p><p>The following example pre-renders one blog post per page called<code>pages/posts/[id].js</code>. The list of blog posts will be fetched from a CMS and returned by<code>getStaticPaths</code>. Then, for each page, it fetches the post data from a CMS using<a href="/docs/guide/api-reference/data-fetching/get-static-props"><code>getStaticProps</code></a>.</p><div class="language-jsx" data-ext="jsx"><pre class="language-jsx"><code><span class="token comment">// pages/posts/[id].js</span>

<span class="token keyword">function</span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> post <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Render post...</span>
<span class="token punctuation">}</span>

<span class="token comment">// This function gets called at build time</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Call an external API endpoint to get posts</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://.../posts&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// Get the paths we want to pre-render based on posts</span>
  <span class="token keyword">const</span> paths <span class="token operator">=</span> posts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> post<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">// We&#39;ll pre-render only these paths at build time.</span>
  <span class="token comment">// { fallback: false } means other routes should 404.</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> paths<span class="token punctuation">,</span> <span class="token literal-property property">fallback</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// This also gets called at build time</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// params contains the post \`id\`.</span>
  <span class="token comment">// If the route is like /posts/1, then params.id is 1</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">https://.../posts/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>params<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// Pass post data to the page via props</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> post <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Post

</code></pre></div><h3 id="fallback-true" tabindex="-1"><a class="header-anchor" href="#fallback-true" aria-hidden="true">#</a> fallback: true</h3>`,20),u={class:"custom-container details"},d=a("summary",null,"示例",-1),k={href:"https://static-tweet.vercel.app",target:"_blank",rel:"noopener noreferrer"},h=n(`<p>If<code>fallback</code>is<code>true</code>, then the behavior of<code>getStaticProps</code>changes in the following ways:</p><ul><li>The paths returned from<code>getStaticPaths</code>will be rendered to<code>HTML</code>at build time by<code>getStaticProps</code>.- The paths that have not been generated at build time will<strong>not</strong>result in a 404 page. Instead, Next.js will serve a<a href="#fallback-pages">“fallback”</a>version of the page on the first request to such a path. Web crawlers, such as Google, won&#39;t be served a fallback and instead the path will behave as in<a href="#fallback-blocking"><code>fallback: &#39;blocking&#39;</code></a>.- When a page with<code>fallback: true</code>is navigated to through<code>next/link</code>or<code>next/router</code>(client-side) Next.js willnotserve a fallback and instead the page will behave as<a href="#fallback-blocking"><code>fallback: &#39;blocking&#39;</code></a>.- In the background, Next.js will statically generate the requested path<code>HTML</code>and<code>JSON</code>. This includes running<code>getStaticProps</code>.- When complete, the browser receives the<code>JSON</code>for the generated path. This will be used to automatically render the page with the required props. From the user’s perspective, the page will be swapped from the fallback page to the full page.- At the same time, Next.js adds this path to the list of pre-rendered pages. Subsequent requests to the same path will serve the generated page, like other pages pre-rendered at build time.</li></ul><blockquote><p><strong>Note:</strong><code>fallback: true</code>is not supported when using<a href="/docs/guide/advanced-features/static-html-export"><code>next export</code></a>.</p></blockquote><h4 id="when-is-fallback-true-useful" tabindex="-1"><a class="header-anchor" href="#when-is-fallback-true-useful" aria-hidden="true">#</a> When is fallback: true useful?</h4><p><code>fallback: true</code>is useful if your app has a very large number of static pages that depend on data (such as a very large e-commerce site). If you want to pre-render all product pages, the builds would take a very long time.</p><p>Instead, you may statically generate a small subset of pages and use<code>fallback: true</code>for the rest. When someone requests a page that is not generated yet, the user will see the page with a loading indicator or skeleton component.</p><p>Shortly after,<code>getStaticProps</code>finishes and the page will be rendered with the requested data. From now on, everyone who requests the same page will get the statically pre-rendered page.</p><p>This ensures that users always have a fast experience while preserving fast builds and the benefits of Static Generation.</p><p><code>fallback: true</code>will notupdategenerated pages, for that take a look at<a href="/docs/guide/basic-features/data-fetching/incremental-static-regeneration">Incremental Static Regeneration</a>.</p><h3 id="fallback-blocking" tabindex="-1"><a class="header-anchor" href="#fallback-blocking" aria-hidden="true">#</a> fallback: &#39;blocking&#39;</h3><p>If<code>fallback</code>is<code>&#39;blocking&#39;</code>, new paths not returned by<code>getStaticPaths</code>will wait for the<code>HTML</code>to be generated, identical to SSR (hence whyblocking), and then be cached for future requests so it only happens once per path.</p><p><code>getStaticProps</code>will behave as follows:</p><ul><li>The paths returned from<code>getStaticPaths</code>will be rendered to<code>HTML</code>at build time by<code>getStaticProps</code>.- The paths that have not been generated at build time will<strong>not</strong>result in a 404 page. Instead, Next.js will SSR on the first request and return the generated<code>HTML</code>.- When complete, the browser receives the<code>HTML</code>for the generated path. From the user’s perspective, it will transition from &quot;the browser is requesting the page&quot; to &quot;the full page is loaded&quot;. There is no flash of loading/fallback state.- At the same time, Next.js adds this path to the list of pre-rendered pages. Subsequent requests to the same path will serve the generated page, like other pages pre-rendered at build time.</li></ul><p><code>fallback: &#39;blocking&#39;</code>will notupdategenerated pages by default. To update generated pages, use<a href="/docs/guide/basic-features/data-fetching/incremental-static-regeneration">Incremental Static Regeneration</a>in conjunction with<code>fallback: &#39;blocking&#39;</code>.</p><blockquote><p><strong>Note:</strong><code>fallback: &#39;blocking&#39;</code>is not supported when using<a href="/docs/guide/advanced-features/static-html-export"><code>next export</code></a>.</p></blockquote><h3 id="fallback-pages" tabindex="-1"><a class="header-anchor" href="#fallback-pages" aria-hidden="true">#</a> Fallback pages</h3><p>In the “fallback” version of a page:</p><ul><li>The page’s props will be empty.- Using the<a href="/docs/guide/api-reference/next/router">router</a>, you can detect if the fallback is being rendered,<code>router.isFallback</code>will be<code>true</code>.</li></ul><p>The following example showcases using<code>isFallback</code>:</p><div class="language-jsx" data-ext="jsx"><pre class="language-jsx"><code><span class="token comment">// pages/posts/[id].js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next/router&#39;</span>

<span class="token keyword">function</span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> post <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// If the page is not yet generated, this will be displayed</span>
  <span class="token comment">// initially until getStaticProps() finishes running</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>router<span class="token punctuation">.</span>isFallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Render post...</span>
<span class="token punctuation">}</span>

<span class="token comment">// This function gets called at build time</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// Only \`/posts/1\` and \`/posts/2\` are generated at build time</span>
    <span class="token literal-property property">paths</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;1&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// Enable statically generating additional pages</span>
    <span class="token comment">// For example: \`/posts/3\`</span>
    <span class="token literal-property property">fallback</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// This also gets called at build time</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// params contains the post \`id\`.</span>
  <span class="token comment">// If the route is like /posts/1, then params.id is 1</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">https://.../posts/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>params<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// Pass post data to the page via props</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> post <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// Re-generate the post at most once per second</span>
    <span class="token comment">// if a request comes in</span>
    <span class="token literal-property property">revalidate</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Post

</code></pre></div><h2 id="getstaticpaths-with-typescript" tabindex="-1"><a class="header-anchor" href="#getstaticpaths-with-typescript" aria-hidden="true">#</a> getStaticPaths with TypeScript</h2><p>For TypeScript, you can use the<code>GetStaticPaths</code>type from<code>next</code>:</p><div class="language-typescript" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> GetStaticPaths <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> getStaticPaths<span class="token operator">:</span> <span class="token function-variable function">GetStaticPaths</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

</code></pre></div>`,23);function g(f,m){const s=t("ExternalLinkIcon");return o(),p("div",null,[i,a("details",u,[d,a("ul",null,[a("li",null,[a("a",k,[c("Static generation of a large number of pages"),l(s)])])])]),h])}const b=e(r,[["render",g],["__file","get-static-paths.html.vue"]]);export{b as default};
