import{_ as s,r,o as i,c,b as t,d as e,e as a,a as o}from"./app.1ad2624e.js";const l={},p=o('<h1 id="deployment" tabindex="-1"><a class="header-anchor" href="#deployment" aria-hidden="true">#</a> Deployment</h1><p>Congratulations, you are ready to deploy your Next.js application to production. This document will show how to deploy either managed or self-hosted using the<a href="#nextjs-build-api">Next.js Build API</a>.</p><h2 id="next-js-build-api" tabindex="-1"><a class="header-anchor" href="#next-js-build-api" aria-hidden="true">#</a> Next.js Build API</h2><p><code>next build</code>generates an optimized version of your application for production. This standard output includes:</p><ul><li>HTML files for pages using<code>getStaticProps</code>or<a href="/docs/guide/advanced-features/automatic-static-optimization">Automatic Static Optimization</a>- CSS files for global styles or for individually scoped styles- JavaScript for pre-rendering dynamic content from the Next.js server- JavaScript for interactivity on the client-side through React</li></ul><p>This output is generated inside the<code>.next</code>folder:</p><ul><li><code>.next/static/chunks/pages</code>– Each JavaScript file inside this folder relates to the route with the same name. For example,<code>.next/static/chunks/pages/about.js</code>would be the JavaScript file loaded when viewing the<code>/about</code>route in your application- <code>.next/static/media</code>– Statically imported images from<code>next/image</code>are hashed and copied here- <code>.next/static/css</code>– Global CSS files for all pages in your application- <code>.next/server/pages</code>– The HTML and JavaScript entry points prerendered from the server. The<code>.nft.json</code>files are created when<a href="/docs/guide/advanced-features/output-file-tracing">Output File Tracing</a>is enabled and contain all the file paths that depend on a given page.- <code>.next/server/chunks</code>– Shared JavaScript chunks used in multiple places throughout your application- <code>.next/cache</code>– Output for the build cache and cached images, responses, and pages from the Next.js server. Using a cache helps decrease build times and improve performance of loading images</li></ul><p>All JavaScript code inside<code>.next</code>has been<strong>compiled</strong>and browser bundles have been<strong>minified</strong>to help achieve the best performance and support<a href="/docs/guide/basic-features/supported-browsers-features">all modern browsers</a>.</p><h2 id="managed-next-js-with-vercel" tabindex="-1"><a class="header-anchor" href="#managed-next-js-with-vercel" aria-hidden="true">#</a> Managed Next.js with Vercel</h2>',9),d={href:"https://vercel.com?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},u={href:"https://vercel.com/solutions/nextjs?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},h=t("code",null,"next build",-1),m={href:"https://vercel.com/features/previews?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},f=t("a",{href:"/docs/guide/basic-features/pages"},"Pages",-1),g={href:"https://vercel.com/features/infrastructure?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},_=t("a",{href:"/docs/guide/api-routes/introduction"},"API Routes",-1),k={href:"https://vercel.com/features/infrastructure?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},x=t("a",{href:"/docs/middleware"},"Middleware",-1),b={href:"https://vercel.com/features/edge-functions?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},v=t("p",null,"In addition, Vercel provides features like:",-1),y={href:"https://vercel.com/analytics?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},w={href:"https://vercel.com/docs/environment-variables?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},j={href:"https://vercel.com/docs/custom-domains?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},S=t("a",{href:"/docs/guide/basic-features/image-optimization"},"Image Optimization",-1),N=t("code",null,"next/image",-1),I=t("code",null,"git push",-1),T={href:"https://vercel.com/new/git/external?repository-url=https://github.com/vercel/next.js/tree/canary/examples/hello-world&project-name=hello-world&repository-name=hello-world&utm_source=next-site&utm_medium=docs&utm_campaign=next-website",target:"_blank",rel:"noopener noreferrer"},A=o('<h2 id="self-hosting" tabindex="-1"><a class="header-anchor" href="#self-hosting" aria-hidden="true">#</a> Self-Hosting</h2><p>You can self-host Next.js with support for all features using Node.js or Docker. You can also do a Static HTML Export, which<a href="/docs/guide/advanced-features/static-html-export">has some limitations</a>.</p><h3 id="node-js-server" tabindex="-1"><a class="header-anchor" href="#node-js-server" aria-hidden="true">#</a> Node.js Server</h3>',3),q={href:"https://aws.amazon.com/ec2/",target:"_blank",rel:"noopener noreferrer"},C={href:"https://www.digitalocean.com/products/droplets/",target:"_blank",rel:"noopener noreferrer"},E=o(`<p>First, ensure your<code>package.json</code>has the<code>&quot;build&quot;</code>and<code>&quot;start&quot;</code>scripts:</p><div class="language-json" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;next dev&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;next build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;next start&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Then, run<code>next build</code>to build your application. Finally, run<code>next start</code>to start the Node.js server. This server supports all features of Next.js.</p>`,3),z=t("a",{href:"/docs/guide/basic-features/image-optimization"},[t("code",null,"next/image")],-1),D=t("code",null,"sharp",-1),G=t("a",{href:"/docs/guide/basic-features/image-optimization"},"Image Optimization",-1),H=t("code",null,"npm install sharp",-1),L=t("code",null,"sharp",-1),M={href:"https://sharp.pixelplumbing.com/install#linux-memory-allocator",target:"_blank",rel:"noopener noreferrer"},P=t("h3",{id:"docker-image",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#docker-image","aria-hidden":"true"},"#"),e(" Docker Image")],-1),R={href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"},V={href:"https://kubernetes.io/",target:"_blank",rel:"noopener noreferrer"},B={href:"https://www.nomadproject.io/",target:"_blank",rel:"noopener noreferrer"},F={href:"https://docs.docker.com/get-docker/",target:"_blank",rel:"noopener noreferrer"},O={href:"https://github.com/vercel/next.js/tree/canary/examples/with-docker",target:"_blank",rel:"noopener noreferrer"},J=t("code",null,"docker build -t nextjs-docker .",-1),W=t("code",null,"docker run -p 3000:3000 nextjs-docker",-1),U={href:"https://github.com/vercel/next.js/tree/canary/examples/with-docker-multi-env",target:"_blank",rel:"noopener noreferrer"},Y=o('<h3 id="static-html-export" tabindex="-1"><a class="header-anchor" href="#static-html-export" aria-hidden="true">#</a> Static HTML Export</h3><p>If you’d like to do a static HTML export of your Next.js app, follow the directions on our<a href="/docs/guide/advanced-features/static-html-export">Static HTML Export documentation</a>.</p><h2 id="other-services" tabindex="-1"><a class="header-anchor" href="#other-services" aria-hidden="true">#</a> Other Services</h2><p>The following services support Next.js<code>v12+</code>. Below, you’ll find examples or guides to deploy Next.js to each service.</p><h3 id="managed-server" tabindex="-1"><a class="header-anchor" href="#managed-server" aria-hidden="true">#</a> Managed Server</h3>',5),X={href:"https://aws.github.io/copilot-cli/",target:"_blank",rel:"noopener noreferrer"},K={href:"https://docs.digitalocean.com/tutorials/app-nextjs-deploy/",target:"_blank",rel:"noopener noreferrer"},Q={href:"https://github.com/vercel/next.js/tree/canary/examples/with-docker",target:"_blank",rel:"noopener noreferrer"},Z={href:"https://elements.heroku.com/buildpacks/mars/heroku-nextjs",target:"_blank",rel:"noopener noreferrer"},$={href:"https://railway.app/new/starters/nextjs-prisma",target:"_blank",rel:"noopener noreferrer"},ee={href:"https://render.com/docs/deploy-nextjs-app",target:"_blank",rel:"noopener noreferrer"},te=t("blockquote",null,[t("p",null,[e("**Note:**There are also managed platforms that allow you to use a Dockerfile as shown in the"),t("a",{href:"/docs/deployment#docker-image"},"example above"),e(".")])],-1),ne=t("h3",{id:"static-only",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#static-only","aria-hidden":"true"},"#"),e(" Static Only")],-1),ae=t("p",null,[e("The following services support deploying Next.js using"),t("a",{href:"/docs/guide/advanced-features/static-html-export"},[t("code",null,"next export")]),e(".")],-1),oe={href:"https://developers.cloudflare.com/pages/framework-guides/deploy-a-nextjs-site/",target:"_blank",rel:"noopener noreferrer"},se={href:"https://github.com/vercel/next.js/tree/canary/examples/with-firebase-hosting",target:"_blank",rel:"noopener noreferrer"},re={href:"https://github.com/vercel/next.js/tree/canary/examples/github-pages",target:"_blank",rel:"noopener noreferrer"},ie=t("p",null,[e("You can also manually deploy the"),t("a",{href:"/docs/guide/advanced-features/static-html-export"},[t("code",null,"next export")]),e("output to any static hosting provider, often through your CI/CD pipeline like GitHub Actions, Jenkins, AWS CodeBuild, Circle CI, Azure Pipelines, and more.")],-1),ce=t("h3",{id:"serverless",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#serverless","aria-hidden":"true"},"#"),e(" Serverless")],-1),le={href:"https://github.com/serverless-nextjs/serverless-next.js",target:"_blank",rel:"noopener noreferrer"},pe={href:"https://learn.microsoft.com/en-us/azure/static-web-apps/nextjs",target:"_blank",rel:"noopener noreferrer"},de={href:"https://github.com/milliHQ/terraform-aws-next-js",target:"_blank",rel:"noopener noreferrer"},ue={href:"https://docs.netlify.com/integrations/frameworks/next-js",target:"_blank",rel:"noopener noreferrer"},he=o(`<blockquote><p>**Note:**Not all serverless providers implement the<a href="/docs/deployment#nextjs-build-api">Next.js Build API</a>from<code>next start</code>. Please check with the provider to see what features are supported.</p></blockquote><h2 id="automatic-updates" tabindex="-1"><a class="header-anchor" href="#automatic-updates" aria-hidden="true">#</a> Automatic Updates</h2><p>When you deploy your Next.js application, you want to see the latest version without needing to reload.</p><p>Next.js will automatically load the latest version of your application in the background when routing. For client-side navigations,<code>next/link</code>will temporarily function as a normal<code>&lt;a&gt;</code>tag.</p><p>**Note:**If a new page (with an old version) has already been prefetched by<code>next/link</code>, Next.js will use the old version. Navigating to a page that hasnotbeen prefetched (and is not cached at the CDN level) will load the latest version.</p><h2 id="manual-graceful-shutdowns" tabindex="-1"><a class="header-anchor" href="#manual-graceful-shutdowns" aria-hidden="true">#</a> Manual Graceful shutdowns</h2><p>Sometimes you might want to run some cleanup code on process signals like<code>SIGTERM</code>or<code>SIGINT</code>.</p><p>You can do that by setting the env variable<code>NEXT_MANUAL_SIG_HANDLE</code>to<code>true</code>and then register a handler for that signal inside your<code>_document.js</code>file.</p><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// pages/_document.js</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NEXT_MANUAL_SIG_HANDLE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this should be added in your custom _document</span>
  process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;SIGTERM&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Received SIGTERM: &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cleaning up&#39;</span><span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;SIGINT&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Received SIGINT: &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cleaning up&#39;</span><span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="related" tabindex="-1"><a class="header-anchor" href="#related" aria-hidden="true">#</a> Related</h2><p>For more information on what to do next, we recommend the following sections:</p>`,11);function me(fe,ge){const n=r("ExternalLinkIcon");return i(),c("div",null,[p,t("p",null,[t("a",d,[e("Vercel"),a(n)]),e("is the fastest way to deploy your Next.js application with zero configuration.")]),t("p",null,[e("When deploying to Vercel, the platform"),t("a",u,[e("automatically detects Next.js"),a(n)]),e(", runs"),h,e(", and optimizes the build output for you, including:")]),t("ul",null,[t("li",null,[e("Persisting cached assets across deployments if unchanged- "),t("a",m,[e("Immutable deployments"),a(n)]),e("with a unique URL for every commit- "),f,e("are automatically statically optimized, if possible- Assets (JavaScript, CSS, images, fonts) are compressed and served from a"),t("a",g,[e("Global Edge Network"),a(n)]),e("- "),_,e("are automatically optimized as isolated"),t("a",k,[e("Serverless Functions"),a(n)]),e("that can scale infinitely- "),x,e("are automatically optimized as"),t("a",b,[e("Edge Functions"),a(n)]),e("that have zero cold starts and boot instantly")])]),v,t("ul",null,[t("li",null,[e("Automatic performance monitoring with"),t("a",y,[e("Next.js Analytics"),a(n)]),e("- Automatic HTTPS and SSL certificates- Automatic CI/CD (through GitHub, GitLab, Bitbucket, etc.)- Support for"),t("a",w,[e("Environment Variables"),a(n)]),e("- Support for"),t("a",j,[e("Custom Domains"),a(n)]),e("- Support for"),S,e("with"),N,e("- Instant global deployments via"),I])]),t("p",null,[t("a",T,[e("Deploy a Next.js application to Vercel"),a(n)]),e("for free to try it out.")]),A,t("p",null,[e("Next.js can be deployed to any hosting provider that supports Node.js. For example,"),t("a",q,[e("AWS EC2"),a(n)]),e("or a"),t("a",C,[e("DigitalOcean Droplet"),a(n)]),e(".")]),E,t("blockquote",null,[t("p",null,[e("If you are using"),z,e(", consider adding"),D,e("for more performant"),G,e("in your production environment by running"),H,e("in your project directory. On Linux platforms,"),L,e("may require"),t("a",M,[e("additional configuration"),a(n)]),e("to prevent excessive memory usage.")])]),P,t("p",null,[e("Next.js can be deployed to any hosting provider that supports"),t("a",R,[e("Docker"),a(n)]),e("containers. You can use this approach when deploying to container orchestrators such as"),t("a",V,[e("Kubernetes"),a(n)]),e("or"),t("a",B,[e("HashiCorp Nomad"),a(n)]),e(", or when running inside a single node in any cloud provider.")]),t("ul",null,[t("li",null,[t("a",F,[e("Install Docker"),a(n)]),e("on your machine- Clone the"),t("a",O,[e("with-docker"),a(n)]),e("example- Build your container:"),J,e("- Run your container:"),W])]),t("p",null,[e("If you need to use different Environment Variables across multiple environments, check out our"),t("a",U,[e("with-docker-multi-env"),a(n)]),e("example.")]),Y,t("ul",null,[t("li",null,[t("a",X,[e("AWS Copilot"),a(n)]),e("- "),t("a",K,[e("Digital Ocean App Platform"),a(n)]),e("- "),t("a",Q,[e("Google Cloud Run"),a(n)]),e("- "),t("a",Z,[e("Heroku"),a(n)]),e("- "),t("a",$,[e("Railway"),a(n)]),e("- "),t("a",ee,[e("Render"),a(n)])])]),te,ne,ae,t("ul",null,[t("li",null,[t("a",oe,[e("Cloudflare Pages"),a(n)]),e("- "),t("a",se,[e("Firebase"),a(n)]),e("- "),t("a",re,[e("GitHub Pages"),a(n)])])]),ie,ce,t("ul",null,[t("li",null,[t("a",le,[e("AWS Serverless"),a(n)]),e("- "),t("a",pe,[e("Azure Static Web Apps"),a(n)]),e("- "),t("a",de,[e("Terraform"),a(n)]),e("- "),t("a",ue,[e("Netlify"),a(n)])])]),he])}const ke=s(l,[["render",me],["__file","deployment.html.vue"]]);export{ke as default};
