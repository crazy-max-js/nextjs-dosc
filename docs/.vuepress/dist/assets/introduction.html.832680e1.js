import{_ as o,r,o as c,c as p,b as e,d as n,e as a,a as t}from"./app.1ad2624e.js";const i={},l=e("h1",{id:"api-routes",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#api-routes","aria-hidden":"true"},"#"),n(" API Routes")],-1),u={class:"custom-container details"},d=e("summary",null,"示例",-1),h={href:"https://github.com/vercel/next.js/tree/canary/examples/api-routes",target:"_blank",rel:"noopener noreferrer"},k={href:"https://github.com/vercel/next.js/tree/canary/examples/api-routes-graphql",target:"_blank",rel:"noopener noreferrer"},f={href:"https://github.com/vercel/next.js/tree/canary/examples/api-routes-rest",target:"_blank",rel:"noopener noreferrer"},_={href:"https://github.com/vercel/next.js/tree/canary/examples/api-routes-cors",target:"_blank",rel:"noopener noreferrer"},g=t(`<p>API routes provide a solution to build your<strong>API</strong>with Next.js.</p><p>Any file inside the folder<code>pages/api</code>is mapped to<code>/api/*</code>and will be treated as an API endpoint instead of a<code>page</code>. They are server-side only bundles and won&#39;t increase your client-side bundle size.</p><p>For example, the following API route<code>pages/api/user.js</code>returns a<code>json</code>response with a status code of<code>200</code>:</p><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;John Doe&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote><p><strong>Note</strong>: API Routes will be affected by<a href="/docs/guide/api-reference/next.config.js/custom-page-extensions"><code>pageExtensions</code>configuration</a>in<code>next.config.js</code>.</p></blockquote><p>For an API route to work, you need to export a function as default (a.k.a<strong>request handler</strong>), which then receives the following parameters:</p>`,6),m=e("code",null,"req",-1),x={href:"https://nodejs.org/api/http.html#class-httpincomingmessage",target:"_blank",rel:"noopener noreferrer"},y=e("a",{href:"/docs/guide/api-routes/request-helpers"},"pre-built middlewares",-1),b=e("code",null,"res",-1),v={href:"https://nodejs.org/api/http.html#class-httpserverresponse",target:"_blank",rel:"noopener noreferrer"},w=e("a",{href:"/docs/guide/api-routes/response-helpers"},"helper functions",-1),P=t(`<p>To handle different HTTP methods in an API route, you can use<code>req.method</code>in your request handler, like so:</p><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Process a POST request</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Handle any other HTTP method</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>To fetch API endpoints, take a look into any of the examples at the start of this section.</p><h2 id="use-cases" tabindex="-1"><a class="header-anchor" href="#use-cases" aria-hidden="true">#</a> Use Cases</h2><p>For new projects, you can build your entire API with API Routes. If you have an existing API, you do not need to forward calls to the API through an API Route. Some other use cases for API Routes are:</p><ul><li>Masking the URL of an external service (e.g.<code>/api/secret</code>instead of<code>https://company.com/secret-url</code>)- Using<a href="/docs/guide/basic-features/environment-variables">Environment Variables</a>on the server to securely access external services.</li></ul><h2 id="caveats" tabindex="-1"><a class="header-anchor" href="#caveats" aria-hidden="true">#</a> Caveats</h2>`,7),I={href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"},A=e("strong",null,"same-origin only",-1),j={href:"https://github.com/vercel/next.js/tree/canary/examples/api-routes-cors",target:"_blank",rel:"noopener noreferrer"},R=e("a",{href:"/docs/guide/advanced-features/static-html-export"},[e("code",null,"next export")],-1),q=e("h2",{id:"related",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#related","aria-hidden":"true"},"#"),n(" Related")],-1),T=e("p",null,"For more information on what to do next, we recommend the following sections:",-1);function S(C,E){const s=r("ExternalLinkIcon");return c(),p("div",null,[l,e("details",u,[d,e("ul",null,[e("li",null,[e("a",h,[n("Basic API Routes"),a(s)]),n("- "),e("a",k,[n("API Routes with GraphQL"),a(s)]),n("- "),e("a",f,[n("API Routes with REST"),a(s)]),n("- "),e("a",_,[n("API Routes with CORS"),a(s)])])])]),g,e("ul",null,[e("li",null,[m,n(": An instance of"),e("a",x,[n("http.IncomingMessage"),a(s)]),n(", plus some"),y,n("- "),b,n(": An instance of"),e("a",v,[n("http.ServerResponse"),a(s)]),n(", plus some"),w])]),P,e("ul",null,[e("li",null,[n("API Routes"),e("a",I,[n("do not specify CORS headers"),a(s)]),n(", meaning they are"),A,n("by default. You can customize such behavior by wrapping the request handler with the"),e("a",j,[n("CORS request helpers"),a(s)]),n(".- API Routes can't be used with"),R])]),q,T])}const O=o(i,[["render",S],["__file","introduction.html.vue"]]);export{O as default};
